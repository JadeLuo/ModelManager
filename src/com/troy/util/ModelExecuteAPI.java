package com.troy.util;

import java.io.IOException;
import java.net.URL;
import java.security.KeyManagementException;
import java.security.NoSuchAlgorithmException;
import java.util.ArrayList;
import java.util.List;

import net.sf.json.JSONObject;

import org.apache.http.HttpException;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;

import com.troy.entity.KeystoneUserEntity;

public class ModelExecuteAPI {
	
	HttpClientUtil hcu = new HttpClientUtil();
	
	
	/**
	 * @author peter
	 * @param Oozieurl
	 * @param userID
	 * @param appPath
	 * @return String
	 * @throws KeyManagementException
	 * @throws NoSuchAlgorithmException
	 * @throws ClientProtocolException
	 * @throws IOException
	 * @throws HttpException
	 */
//	@Deprecated
//	public String startJob(String Oozieurl,String userID,String appPath) throws KeyManagementException, NoSuchAlgorithmException, ClientProtocolException, IOException, HttpException {
//		
//		URL url = new URL("http://"+Oozieurl+"/troy/plugin/scheduler/jobs");
//	   
//        String content = "{\"userName\":\""+userID+"\",\"appPath\":\""+appPath+"\"}";
//        HttpResponse hrp =hcu.doPost(url.toString(), content);
//        
//        
//	    if((hrp.getStatusLine().getStatusCode()) == 201){
//		    return EntityUtils.toString(hrp.getEntity());
//		    
//		   
//	    }else{
//        	throw new HttpException(hrp.getStatusLine().getStatusCode()+"\t"+hrp.getStatusLine().getReasonPhrase());
//		}
//	
//	}
	
	
	/**
	 * ִ�б���
	 * @author peter
	 *
	 * @param Oozieurl
	 * @param modelId
	 * @param appPath
	 * @return
	 * @throws KeyManagementException
	 * @throws NoSuchAlgorithmException
	 * @throws ClientProtocolException
	 * @throws IOException
	 * @throws HttpException
	 */
//	public String startTrans(String Oozieurl,String modelId,String appPath) throws KeyManagementException, NoSuchAlgorithmException, ClientProtocolException, IOException, HttpException {
//		URL url = new URL("http://"+Oozieurl+"/troy/plugin/scheduler/api/schedule/post/submit");
//		   
//		 HttpPost post = new HttpPost(url.toString());
//		
//		List<NameValuePair> params = new ArrayList<NameValuePair>();
//             params.add(new BasicNameValuePair("ctl00$ContentPlaceHolder1$userEmail", "admin"));
//             params.add(new BasicNameValuePair("ctl00$ContentPlaceHolder1$userPassWord", "password"));
//             post.setHeader("Content-Type","application/json");
//             StringEntity se = new StringEntity("{\"appPath\":\"hdfs://datanode1:8020/user/cdhfive/Yun/ModelExplain\",\"kjbHdfsPath\":\"hdfs://192.168.121.35:8020"+appPath+"main/main.kjb\",\"modelId\":\""+modelId+"\"}");
//             post.setEntity(se);
//             post.setEntity(new UrlEncodedFormEntity(params, HTTP.UTF_8)); 
//             HttpResponse response = hcu.httpClient.execute(post);  //
//             System.out.println(response.toString());
//		return "201";
//	   
//       
//	
//	}
	

}
